<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Admin - Productos</title>
    <link rel="stylesheet" href="/admin_dark.css">

    <style>
        body { font-family: Arial; padding: 20px; }
        .topbar { margin-bottom: 20px; }
        a.btn { padding: 6px 10px; background:#333; color:white; text-decoration: none; border-radius: 5px; }
        .buscador-container { margin: 15px 0; display: flex; gap: 10px; }
        .buscador-container input { padding: 8px 12px; width: 280px; }
        .clear-btn { background: #888; }
        table { width: 100%; margin-top: 15px; border-collapse: collapse; }
        th, td { border: 1px solid #ccc; padding: 8px; }
        .acciones a { padding: 6px 10px; background:#333; color:white; border-radius:5px; text-decoration:none; }
    </style>
</head>

<body>
<button id="dark-toggle" class="dark-btn">ðŸŒ™</button>

<div class="topbar">
    <a class="btn" href="/admin/dashboard">Volver al dashboard</a>
    <a class="btn" href="/">Portal Cliente</a>
</div>

<h1>Productos</h1>

<a class="btn" href="/admin/productos/nuevo">Crear Producto</a>

<div class="buscador-container">
    <input type="text" id="buscador" placeholder="Buscar producto por nombre...">
    <button class="btn clear-btn" id="limpiar">Limpiar</button>
</div>

<table id="tabla-productos">
    <thead>
        <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Precio</th>
            <th>CategorÃ­a</th>
            <th>Img</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody id="cuerpo-tabla">

        <% productos.forEach(p => { %>
        <tr>
            <td><%= p.id %></td>
            <td class="nombre-prod"><%= p.nombre %></td>
            <td>$<%= p.precio %></td>
            <td><%= p.categoria %></td>
            <td><img src="<%= p.img %>" width="60"></td>
            <td class="acciones">
                <a href="/admin/productos/editar/<%= p.id %>">Editar</a>
                <a href="/admin/productos/eliminar/<%= p.id %>" style="background:#a30000;">Eliminar</a>
            </td>
        </tr>
        <% }) %>

    </tbody>
</table>

<script>
    const input = document.getElementById("buscador");
    const btnLimpiar = document.getElementById("limpiar");
    const filas = document.querySelectorAll("#cuerpo-tabla tr");

    input.addEventListener("input", filtrarTabla);
    btnLimpiar.addEventListener("click", () => { input.value = ""; filtrarTabla(); });

    function filtrarTabla() {
        const texto = input.value.toLowerCase();

        filas.forEach(f => {
            const nombre = f.querySelector(".nombre-prod").innerText.toLowerCase();
            f.style.display = nombre.includes(texto) ? "" : "none";
        });
    }
</script>

<script src="/admin_darkmode.js"></script>
</body>
</html>
